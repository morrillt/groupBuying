#!/usr/bin/ruby
require File.dirname(__FILE__) + '/../config/environment'

# Called hourly to update the snapshots for a sites active deals

Site.active.map do |site|
  begin
    Thread.new do
      site.update_snapshots!
    end
  rescue => e
    puts "Error:"
    puts "-"*90
    puts e.message
  end
end.map{|t| t.join if t.respond_to?(:join) }